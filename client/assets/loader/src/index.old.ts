//||------------------------------------------------------------------------------------------------||
//|| Main
//|| Loader for the Client
//||------------------------------------------------------------------------------------------------||

//||------------------------------------------------------------------------------------------------||
//|| Import
//||------------------------------------------------------------------------------------------------||

import Utils      from './utils';
import Env        from './env';

//||------------------------------------------------------------------------------------------------||
//|| Call API to Check Session Validity
//||------------------------------------------------------------------------------------------------||

const start = async() => {


      
      try {
            console.log(`ComplyAge Client Loader - ${Env.clientVersion}`);
            console.log(`API Key: ${Utils.gset('apiKey')}`);
            const data = await Utils.checkSession();
            if (data === null) { 
                  console.log("No Session Cookie Found. Checking Zone/Public Key");
            }
            const location = await Utils.checkLocation();
            console.log("AGE GATE", location.ageGate);
            if (location.enforce) {                  
                  const ageGate = atob(location.ageGate || btoa(`<div style="position:fixed; top:0; left:0; width:100%; height:100%; background-color:rgba(0,0,0,0.5); display:flex; justify-content:center; align-items:center; color:white; font-size:24px;">Age Gate Required</div>`));
                  const container = document.createElement('div');
                  container.innerHTML = ageGate;
                  document.body.appendChild(container);
            }
      } catch (error) {
            console.error("An error occurred:", error);
      }
}
;(async () => { await start(); })();

//||------------------------------------------------------------------------------------------------||
//|| We Have a Session Cookie - Check API for Session Validity
//||------------------------------------------------------------------------------------------------||

      //||------------------------------------------------------------------------------------------------||
      //|| Session Valid - Cool
      //||------------------------------------------------------------------------------------------------||

      //||------------------------------------------------------------------------------------------------||
      //|| Session Valid - Cool
      //||------------------------------------------------------------------------------------------------||

      //||------------------------------------------------------------------------------------------------||
      //|| Session Invalid - Need Refresh?
      //||------------------------------------------------------------------------------------------------||
      
      //||------------------------------------------------------------------------------------------------||
      //|| Session Recheck - Bad. Fail
      //||------------------------------------------------------------------------------------------------||

      //||------------------------------------------------------------------------------------------------||
      //|| Session Recheck - Good. Bye!
      //||------------------------------------------------------------------------------------------------||

//||------------------------------------------------------------------------------------------------||
//|| No Cookie. Lets check zone/public key
//||------------------------------------------------------------------------------------------------||


//||------------------------------------------------------------------------------------------------||
//|| No Enforcement - Write NoCheck Session
//||------------------------------------------------------------------------------------------------||


//||------------------------------------------------------------------------------------------------||
//|| Enforcement - Show Enforcement Page
//||------------------------------------------------------------------------------------------------||



